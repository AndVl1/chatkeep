================================================================================
DATABASE SCHEMA SNAPSHOT
Generated from Flyway migrations
================================================================================

APPLIED MIGRATIONS (25):
  1 - init schema
  2 - moderation schema
  3 - add punishment message text
  4 - add username cache
  5 - add log channel id
  6 - add clean service enabled
  7 - rename duration hours to minutes
  8 - add channel reply settings
  9 - add locks feature
  10 - fix locks json type
  11 - add locale support
  12 - add media storage
  13 - add welcome settings
  14 - add rules
  15 - add notes
  16 - add antiflood
  17 - add gated features
  18 - add twitch integration
  19 - fix gated features primary key
  20 - add twitch ended template
  21 - add twitch button text
  22 - add chat type column
  23 - add telegraph url to streams
  24 - add has photo to streams
  25 - add pinned channel

TABLES (25):
--------------------------------------------------------------------------------
TABLE: admin_cache

  COLUMNS (6):
    id: bigint NOT NULL DEFAULT nextval('admin_cache_id_seq'::regclass)
    user_id: bigint NOT NULL
    chat_id: bigint NOT NULL
    is_admin: boolean NOT NULL
    cached_at: timestamp without time zone NOT NULL DEFAULT now()
    expires_at: timestamp without time zone NOT NULL

  INDEXES (4):
    admin_cache_pkey
      CREATE UNIQUE INDEX admin_cache_pkey ON public.admin_cache USING btree (id)
    idx_admin_cache_expires_at
      CREATE INDEX idx_admin_cache_expires_at ON public.admin_cache USING btree (expires_at)
    idx_admin_cache_user_chat
      CREATE INDEX idx_admin_cache_user_chat ON public.admin_cache USING btree (user_id, chat_id)
    uq_admin_cache_user_chat
      CREATE UNIQUE INDEX uq_admin_cache_user_chat ON public.admin_cache USING btree (user_id, chat_id)

  CONSTRAINTS (8):
    CHECK: 2200_16488_1_not_null
    CHECK: 2200_16488_2_not_null
    CHECK: 2200_16488_3_not_null
    CHECK: 2200_16488_4_not_null
    CHECK: 2200_16488_5_not_null
    CHECK: 2200_16488_6_not_null
    PRIMARY KEY: admin_cache_pkey
    UNIQUE: uq_admin_cache_user_chat

--------------------------------------------------------------------------------
TABLE: admin_sessions

  COLUMNS (5):
    id: bigint NOT NULL DEFAULT nextval('admin_sessions_id_seq'::regclass)
    user_id: bigint NOT NULL
    connected_chat_id: bigint NOT NULL
    connected_chat_title: character varying(255) NULL
    created_at: timestamp without time zone NOT NULL DEFAULT now()

  INDEXES (3):
    admin_sessions_pkey
      CREATE UNIQUE INDEX admin_sessions_pkey ON public.admin_sessions USING btree (id)
    admin_sessions_user_id_key
      CREATE UNIQUE INDEX admin_sessions_user_id_key ON public.admin_sessions USING btree (user_id)
    idx_admin_sessions_user_id
      CREATE INDEX idx_admin_sessions_user_id ON public.admin_sessions USING btree (user_id)

  CONSTRAINTS (6):
    CHECK: 2200_16477_1_not_null
    CHECK: 2200_16477_2_not_null
    CHECK: 2200_16477_3_not_null
    CHECK: 2200_16477_5_not_null
    PRIMARY KEY: admin_sessions_pkey
    UNIQUE: admin_sessions_user_id_key

--------------------------------------------------------------------------------
TABLE: antiflood_settings

  COLUMNS (8):
    chat_id: bigint NOT NULL
    enabled: boolean NOT NULL DEFAULT false
    max_messages: integer NOT NULL DEFAULT 5
    time_window_seconds: integer NOT NULL DEFAULT 5
    action: character varying(50) NOT NULL DEFAULT 'MUTE'::character varying
    action_duration_minutes: integer NULL
    created_at: timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP
    updated_at: timestamp with time zone NULL

  INDEXES (2):
    antiflood_settings_pkey
      CREATE UNIQUE INDEX antiflood_settings_pkey ON public.antiflood_settings USING btree (chat_id)
    idx_antiflood_enabled
      CREATE INDEX idx_antiflood_enabled ON public.antiflood_settings USING btree (enabled)

  CONSTRAINTS (7):
    CHECK: 2200_16634_1_not_null
    CHECK: 2200_16634_2_not_null
    CHECK: 2200_16634_3_not_null
    CHECK: 2200_16634_4_not_null
    CHECK: 2200_16634_5_not_null
    CHECK: 2200_16634_7_not_null
    PRIMARY KEY: antiflood_settings_pkey

--------------------------------------------------------------------------------
TABLE: blocklist_patterns

  COLUMNS (8):
    id: bigint NOT NULL DEFAULT nextval('blocklist_patterns_id_seq'::regclass)
    chat_id: bigint NULL
    pattern: character varying(500) NOT NULL
    match_type: character varying(20) NOT NULL
    action: character varying(20) NOT NULL
    action_duration_minutes: integer NULL
    severity: integer NOT NULL DEFAULT 0
    created_at: timestamp without time zone NOT NULL DEFAULT now()

  INDEXES (2):
    blocklist_patterns_pkey
      CREATE UNIQUE INDEX blocklist_patterns_pkey ON public.blocklist_patterns USING btree (id)
    idx_blocklist_patterns_chat_id
      CREATE INDEX idx_blocklist_patterns_chat_id ON public.blocklist_patterns USING btree (chat_id)

  CONSTRAINTS (7):
    CHECK: 2200_16465_1_not_null
    CHECK: 2200_16465_3_not_null
    CHECK: 2200_16465_4_not_null
    CHECK: 2200_16465_5_not_null
    CHECK: 2200_16465_7_not_null
    CHECK: 2200_16465_8_not_null
    PRIMARY KEY: blocklist_patterns_pkey

--------------------------------------------------------------------------------
TABLE: channel_reply_settings

  COLUMNS (10):
    id: bigint NOT NULL DEFAULT nextval('channel_reply_settings_id_seq'::regclass)
    chat_id: bigint NOT NULL
    enabled: boolean NOT NULL DEFAULT false
    reply_text: text NULL
    media_file_id: text NULL
    media_type: character varying(20) NULL
    buttons_json: text NULL
    created_at: timestamp with time zone NULL DEFAULT now()
    updated_at: timestamp with time zone NULL DEFAULT now()
    media_hash: character varying(32) NULL

  INDEXES (2):
    channel_reply_settings_chat_id_key
      CREATE UNIQUE INDEX channel_reply_settings_chat_id_key ON public.channel_reply_settings USING btree (chat_id)
    channel_reply_settings_pkey
      CREATE UNIQUE INDEX channel_reply_settings_pkey ON public.channel_reply_settings USING btree (id)

  CONSTRAINTS (6):
    CHECK: 2200_16515_1_not_null
    CHECK: 2200_16515_2_not_null
    CHECK: 2200_16515_3_not_null
    FOREIGN KEY: fk_media_hash ON DELETE SET NULL
    PRIMARY KEY: channel_reply_settings_pkey
    UNIQUE: channel_reply_settings_chat_id_key

--------------------------------------------------------------------------------
TABLE: chat_gated_features

  COLUMNS (6):
    id: bigint NOT NULL
    chat_id: bigint NOT NULL
    feature_key: character varying(50) NOT NULL
    enabled: boolean NULL DEFAULT false
    enabled_at: timestamp without time zone NULL
    enabled_by: bigint NULL

  INDEXES (3):
    chat_gated_features_new_pkey
      CREATE UNIQUE INDEX chat_gated_features_new_pkey ON public.chat_gated_features USING btree (id)
    idx_gated_features_chat
      CREATE INDEX idx_gated_features_chat ON public.chat_gated_features USING btree (chat_id)
    uq_chat_gated_features_chat_feature
      CREATE UNIQUE INDEX uq_chat_gated_features_chat_feature ON public.chat_gated_features USING btree (chat_id, feature_key)

  CONSTRAINTS (4):
    CHECK: 2200_16710_1_not_null
    CHECK: 2200_16710_2_not_null
    CHECK: 2200_16710_3_not_null
    PRIMARY KEY: chat_gated_features_new_pkey

--------------------------------------------------------------------------------
TABLE: chat_settings

  COLUMNS (8):
    id: bigint NOT NULL DEFAULT nextval('chat_settings_id_seq'::regclass)
    chat_id: bigint NOT NULL
    chat_title: character varying(255) NULL
    collection_enabled: boolean NOT NULL DEFAULT true
    created_at: timestamp without time zone NOT NULL DEFAULT now()
    updated_at: timestamp without time zone NOT NULL DEFAULT now()
    locale: character varying(5) NOT NULL DEFAULT 'en'::character varying
    chat_type: character varying(20) NOT NULL DEFAULT 'GROUP'::character varying

  INDEXES (3):
    chat_settings_chat_id_key
      CREATE UNIQUE INDEX chat_settings_chat_id_key ON public.chat_settings USING btree (chat_id)
    chat_settings_pkey
      CREATE UNIQUE INDEX chat_settings_pkey ON public.chat_settings USING btree (id)
    idx_chat_settings_chat_id
      CREATE INDEX idx_chat_settings_chat_id ON public.chat_settings USING btree (chat_id)

  CONSTRAINTS (9):
    CHECK: 2200_16395_1_not_null
    CHECK: 2200_16395_2_not_null
    CHECK: 2200_16395_4_not_null
    CHECK: 2200_16395_5_not_null
    CHECK: 2200_16395_6_not_null
    CHECK: 2200_16395_7_not_null
    CHECK: 2200_16395_8_not_null
    PRIMARY KEY: chat_settings_pkey
    UNIQUE: chat_settings_chat_id_key

--------------------------------------------------------------------------------
TABLE: flyway_schema_history

  COLUMNS (10):
    installed_rank: integer NOT NULL
    version: character varying(50) NULL
    description: character varying(200) NOT NULL
    type: character varying(20) NOT NULL
    script: character varying(1000) NOT NULL
    checksum: integer NULL
    installed_by: character varying(100) NOT NULL
    installed_on: timestamp without time zone NOT NULL DEFAULT now()
    execution_time: integer NOT NULL
    success: boolean NOT NULL

  INDEXES (2):
    flyway_schema_history_pk
      CREATE UNIQUE INDEX flyway_schema_history_pk ON public.flyway_schema_history USING btree (installed_rank)
    flyway_schema_history_s_idx
      CREATE INDEX flyway_schema_history_s_idx ON public.flyway_schema_history USING btree (success)

  CONSTRAINTS (9):
    CHECK: 2200_16385_10_not_null
    CHECK: 2200_16385_1_not_null
    CHECK: 2200_16385_3_not_null
    CHECK: 2200_16385_4_not_null
    CHECK: 2200_16385_5_not_null
    CHECK: 2200_16385_7_not_null
    CHECK: 2200_16385_8_not_null
    CHECK: 2200_16385_9_not_null
    PRIMARY KEY: flyway_schema_history_pk

--------------------------------------------------------------------------------
TABLE: lock_allowlist

  COLUMNS (5):
    id: bigint NOT NULL DEFAULT nextval('lock_allowlist_id_seq'::regclass)
    chat_id: bigint NOT NULL
    allowlist_type: character varying(50) NOT NULL
    pattern: character varying(1024) NOT NULL
    created_at: timestamp with time zone NOT NULL DEFAULT now()

  INDEXES (4):
    idx_lock_allowlist_chat_id
      CREATE INDEX idx_lock_allowlist_chat_id ON public.lock_allowlist USING btree (chat_id)
    idx_lock_allowlist_chat_type
      CREATE INDEX idx_lock_allowlist_chat_type ON public.lock_allowlist USING btree (chat_id, allowlist_type)
    lock_allowlist_pkey
      CREATE UNIQUE INDEX lock_allowlist_pkey ON public.lock_allowlist USING btree (id)
    uq_lock_allowlist
      CREATE UNIQUE INDEX uq_lock_allowlist ON public.lock_allowlist USING btree (chat_id, allowlist_type, pattern)

  CONSTRAINTS (7):
    CHECK: 2200_16552_1_not_null
    CHECK: 2200_16552_2_not_null
    CHECK: 2200_16552_3_not_null
    CHECK: 2200_16552_4_not_null
    CHECK: 2200_16552_5_not_null
    PRIMARY KEY: lock_allowlist_pkey
    UNIQUE: uq_lock_allowlist

--------------------------------------------------------------------------------
TABLE: lock_exemptions

  COLUMNS (6):
    id: bigint NOT NULL DEFAULT nextval('lock_exemptions_id_seq'::regclass)
    chat_id: bigint NOT NULL
    lock_type: character varying(50) NULL
    exemption_type: character varying(50) NOT NULL
    exemption_value: character varying(255) NOT NULL
    created_at: timestamp with time zone NOT NULL DEFAULT now()

  INDEXES (4):
    idx_lock_exemptions_chat_id
      CREATE INDEX idx_lock_exemptions_chat_id ON public.lock_exemptions USING btree (chat_id)
    idx_lock_exemptions_chat_lock_type
      CREATE INDEX idx_lock_exemptions_chat_lock_type ON public.lock_exemptions USING btree (chat_id, lock_type)
    lock_exemptions_pkey
      CREATE UNIQUE INDEX lock_exemptions_pkey ON public.lock_exemptions USING btree (id)
    uq_lock_exemptions
      CREATE UNIQUE INDEX uq_lock_exemptions ON public.lock_exemptions USING btree (chat_id, lock_type, exemption_type, exemption_value)

  CONSTRAINTS (7):
    CHECK: 2200_16540_1_not_null
    CHECK: 2200_16540_2_not_null
    CHECK: 2200_16540_4_not_null
    CHECK: 2200_16540_5_not_null
    CHECK: 2200_16540_6_not_null
    PRIMARY KEY: lock_exemptions_pkey
    UNIQUE: uq_lock_exemptions

--------------------------------------------------------------------------------
TABLE: lock_settings

  COLUMNS (5):
    chat_id: bigint NOT NULL
    locks_json: text NOT NULL DEFAULT '{}'::text
    lock_warns: boolean NOT NULL DEFAULT false
    created_at: timestamp with time zone NOT NULL DEFAULT now()
    updated_at: timestamp with time zone NOT NULL DEFAULT now()

  INDEXES (1):
    lock_settings_pkey
      CREATE UNIQUE INDEX lock_settings_pkey ON public.lock_settings USING btree (chat_id)

  CONSTRAINTS (6):
    CHECK: 2200_16528_1_not_null
    CHECK: 2200_16528_2_not_null
    CHECK: 2200_16528_3_not_null
    CHECK: 2200_16528_4_not_null
    CHECK: 2200_16528_5_not_null
    PRIMARY KEY: lock_settings_pkey

--------------------------------------------------------------------------------
TABLE: media_storage

  COLUMNS (7):
    id: bigint NOT NULL DEFAULT nextval('media_storage_id_seq'::regclass)
    hash: character varying(32) NOT NULL
    content: bytea NOT NULL
    mime_type: character varying(100) NOT NULL
    file_size: bigint NOT NULL
    telegram_file_id: text NULL
    created_at: timestamp with time zone NULL DEFAULT now()

  INDEXES (3):
    idx_media_storage_created_at
      CREATE INDEX idx_media_storage_created_at ON public.media_storage USING btree (created_at)
    media_storage_hash_key
      CREATE UNIQUE INDEX media_storage_hash_key ON public.media_storage USING btree (hash)
    media_storage_pkey
      CREATE UNIQUE INDEX media_storage_pkey ON public.media_storage USING btree (id)

  CONSTRAINTS (7):
    CHECK: 2200_16583_1_not_null
    CHECK: 2200_16583_2_not_null
    CHECK: 2200_16583_3_not_null
    CHECK: 2200_16583_4_not_null
    CHECK: 2200_16583_5_not_null
    PRIMARY KEY: media_storage_pkey
    UNIQUE: media_storage_hash_key

--------------------------------------------------------------------------------
TABLE: messages

  COLUMNS (10):
    id: bigint NOT NULL DEFAULT nextval('messages_id_seq'::regclass)
    telegram_message_id: bigint NOT NULL
    chat_id: bigint NOT NULL
    user_id: bigint NOT NULL
    username: character varying(255) NULL
    first_name: character varying(255) NULL
    last_name: character varying(255) NULL
    text: text NOT NULL
    message_date: timestamp without time zone NOT NULL
    created_at: timestamp without time zone NOT NULL DEFAULT now()

  INDEXES (5):
    idx_messages_chat_id
      CREATE INDEX idx_messages_chat_id ON public.messages USING btree (chat_id)
    idx_messages_date
      CREATE INDEX idx_messages_date ON public.messages USING btree (message_date)
    idx_messages_user_id
      CREATE INDEX idx_messages_user_id ON public.messages USING btree (user_id)
    messages_pkey
      CREATE UNIQUE INDEX messages_pkey ON public.messages USING btree (id)
    uq_chat_message
      CREATE UNIQUE INDEX uq_chat_message ON public.messages USING btree (chat_id, telegram_message_id)

  CONSTRAINTS (9):
    CHECK: 2200_16407_10_not_null
    CHECK: 2200_16407_1_not_null
    CHECK: 2200_16407_2_not_null
    CHECK: 2200_16407_3_not_null
    CHECK: 2200_16407_4_not_null
    CHECK: 2200_16407_8_not_null
    CHECK: 2200_16407_9_not_null
    PRIMARY KEY: messages_pkey
    UNIQUE: uq_chat_message

--------------------------------------------------------------------------------
TABLE: moderation_config

  COLUMNS (11):
    id: bigint NOT NULL DEFAULT nextval('moderation_config_id_seq'::regclass)
    chat_id: bigint NOT NULL
    max_warnings: integer NOT NULL DEFAULT 3
    warning_ttl_hours: integer NOT NULL DEFAULT 24
    threshold_action: character varying(20) NOT NULL DEFAULT 'MUTE'::character varying
    threshold_duration_minutes: integer NULL DEFAULT 24
    default_blocklist_action: character varying(20) NOT NULL DEFAULT 'WARN'::character varying
    created_at: timestamp without time zone NOT NULL DEFAULT now()
    updated_at: timestamp without time zone NOT NULL DEFAULT now()
    log_channel_id: bigint NULL
    clean_service_enabled: boolean NOT NULL DEFAULT false

  INDEXES (3):
    idx_moderation_config_chat_id
      CREATE INDEX idx_moderation_config_chat_id ON public.moderation_config USING btree (chat_id)
    moderation_config_chat_id_key
      CREATE UNIQUE INDEX moderation_config_chat_id_key ON public.moderation_config USING btree (chat_id)
    moderation_config_pkey
      CREATE UNIQUE INDEX moderation_config_pkey ON public.moderation_config USING btree (id)

  CONSTRAINTS (11):
    CHECK: 2200_16448_11_not_null
    CHECK: 2200_16448_1_not_null
    CHECK: 2200_16448_2_not_null
    CHECK: 2200_16448_3_not_null
    CHECK: 2200_16448_4_not_null
    CHECK: 2200_16448_5_not_null
    CHECK: 2200_16448_7_not_null
    CHECK: 2200_16448_8_not_null
    CHECK: 2200_16448_9_not_null
    PRIMARY KEY: moderation_config_pkey
    UNIQUE: moderation_config_chat_id_key

--------------------------------------------------------------------------------
TABLE: notes

  COLUMNS (7):
    id: bigint NOT NULL DEFAULT nextval('notes_id_seq'::regclass)
    chat_id: bigint NOT NULL
    note_name: character varying(255) NOT NULL
    content: text NOT NULL
    created_by: bigint NOT NULL
    created_at: timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP
    updated_at: timestamp with time zone NULL

  INDEXES (4):
    idx_notes_chat_id
      CREATE INDEX idx_notes_chat_id ON public.notes USING btree (chat_id)
    idx_notes_name
      CREATE INDEX idx_notes_name ON public.notes USING btree (chat_id, note_name)
    notes_pkey
      CREATE UNIQUE INDEX notes_pkey ON public.notes USING btree (id)
    notes_unique_name
      CREATE UNIQUE INDEX notes_unique_name ON public.notes USING btree (chat_id, note_name)

  CONSTRAINTS (8):
    CHECK: 2200_16621_1_not_null
    CHECK: 2200_16621_2_not_null
    CHECK: 2200_16621_3_not_null
    CHECK: 2200_16621_4_not_null
    CHECK: 2200_16621_5_not_null
    CHECK: 2200_16621_6_not_null
    PRIMARY KEY: notes_pkey
    UNIQUE: notes_unique_name

--------------------------------------------------------------------------------
TABLE: punishments

  COLUMNS (10):
    id: bigint NOT NULL DEFAULT nextval('punishments_id_seq'::regclass)
    chat_id: bigint NOT NULL
    user_id: bigint NOT NULL
    issued_by_id: bigint NOT NULL
    punishment_type: character varying(20) NOT NULL
    duration_seconds: bigint NULL
    reason: character varying(500) NULL
    source: character varying(20) NOT NULL
    created_at: timestamp without time zone NOT NULL DEFAULT now()
    message_text: text NULL

  INDEXES (4):
    idx_punishments_chat_id
      CREATE INDEX idx_punishments_chat_id ON public.punishments USING btree (chat_id)
    idx_punishments_created_at
      CREATE INDEX idx_punishments_created_at ON public.punishments USING btree (created_at)
    idx_punishments_user_id
      CREATE INDEX idx_punishments_user_id ON public.punishments USING btree (user_id)
    punishments_pkey
      CREATE UNIQUE INDEX punishments_pkey ON public.punishments USING btree (id)

  CONSTRAINTS (8):
    CHECK: 2200_16435_1_not_null
    CHECK: 2200_16435_2_not_null
    CHECK: 2200_16435_3_not_null
    CHECK: 2200_16435_4_not_null
    CHECK: 2200_16435_5_not_null
    CHECK: 2200_16435_8_not_null
    CHECK: 2200_16435_9_not_null
    PRIMARY KEY: punishments_pkey

--------------------------------------------------------------------------------
TABLE: rules

  COLUMNS (4):
    chat_id: bigint NOT NULL
    rules_text: text NOT NULL
    created_at: timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP
    updated_at: timestamp with time zone NULL

  INDEXES (2):
    idx_rules_created_at
      CREATE INDEX idx_rules_created_at ON public.rules USING btree (created_at)
    rules_pkey
      CREATE UNIQUE INDEX rules_pkey ON public.rules USING btree (chat_id)

  CONSTRAINTS (4):
    CHECK: 2200_16611_1_not_null
    CHECK: 2200_16611_2_not_null
    CHECK: 2200_16611_3_not_null
    PRIMARY KEY: rules_pkey

--------------------------------------------------------------------------------
TABLE: stream_timeline_events

  COLUMNS (6):
    id: bigint NOT NULL DEFAULT nextval('stream_timeline_events_id_seq'::regclass)
    stream_id: bigint NOT NULL
    event_time: timestamp without time zone NOT NULL DEFAULT CURRENT_TIMESTAMP
    stream_offset_seconds: integer NOT NULL
    game_name: character varying(200) NULL
    stream_title: text NULL

  INDEXES (2):
    idx_timeline_stream
      CREATE INDEX idx_timeline_stream ON public.stream_timeline_events USING btree (stream_id)
    stream_timeline_events_pkey
      CREATE UNIQUE INDEX stream_timeline_events_pkey ON public.stream_timeline_events USING btree (id)

  CONSTRAINTS (6):
    CHECK: 2200_16685_1_not_null
    CHECK: 2200_16685_2_not_null
    CHECK: 2200_16685_3_not_null
    CHECK: 2200_16685_4_not_null
    FOREIGN KEY: stream_timeline_events_stream_id_fkey ON DELETE CASCADE
    PRIMARY KEY: stream_timeline_events_pkey

--------------------------------------------------------------------------------
TABLE: twitch_channel_subscriptions

  COLUMNS (11):
    id: bigint NOT NULL DEFAULT nextval('twitch_channel_subscriptions_id_seq'::regclass)
    chat_id: bigint NOT NULL
    twitch_channel_id: character varying(50) NOT NULL
    twitch_login: character varying(50) NOT NULL
    display_name: character varying(100) NULL
    avatar_url: text NULL
    eventsub_subscription_id: character varying(100) NULL
    created_at: timestamp without time zone NOT NULL DEFAULT CURRENT_TIMESTAMP
    created_by: bigint NULL
    is_pinned: boolean NOT NULL DEFAULT false
    pin_silently: boolean NOT NULL DEFAULT true

  INDEXES (4):
    idx_twitch_subscriptions_channel
      CREATE INDEX idx_twitch_subscriptions_channel ON public.twitch_channel_subscriptions USING btree (twitch_channel_id)
    idx_twitch_subscriptions_chat
      CREATE INDEX idx_twitch_subscriptions_chat ON public.twitch_channel_subscriptions USING btree (chat_id)
    twitch_channel_subscriptions_chat_id_twitch_channel_id_key
      CREATE UNIQUE INDEX twitch_channel_subscriptions_chat_id_twitch_channel_id_key ON public.twitch_channel_subscriptions USING btree (chat_id, twitch_channel_id)
    twitch_channel_subscriptions_pkey
      CREATE UNIQUE INDEX twitch_channel_subscriptions_pkey ON public.twitch_channel_subscriptions USING btree (id)

  CONSTRAINTS (9):
    CHECK: 2200_16653_10_not_null
    CHECK: 2200_16653_11_not_null
    CHECK: 2200_16653_1_not_null
    CHECK: 2200_16653_2_not_null
    CHECK: 2200_16653_3_not_null
    CHECK: 2200_16653_4_not_null
    CHECK: 2200_16653_8_not_null
    PRIMARY KEY: twitch_channel_subscriptions_pkey
    UNIQUE: twitch_channel_subscriptions_chat_id_twitch_channel_id_key

--------------------------------------------------------------------------------
TABLE: twitch_notification_settings

  COLUMNS (6):
    chat_id: bigint NOT NULL
    message_template: text NOT NULL DEFAULT 'üî¥ {streamer} –Ω–∞—á–∞–ª —Å—Ç—Ä–∏–º!

{title}

üéÆ {game}
üë• {viewers} –∑—Ä–∏—Ç–µ–ª–µ–π
‚è± {duration}'::text
    created_at: timestamp without time zone NOT NULL DEFAULT CURRENT_TIMESTAMP
    updated_at: timestamp without time zone NULL
    ended_message_template: text NULL DEFAULT '‚ö´Ô∏è {streamer} –∑–∞–≤–µ—Ä—à–∏–ª —Å—Ç—Ä–∏–º

{title}

üéÆ {game}
‚è± –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {duration}'::text
    button_text: character varying(64) NULL DEFAULT 'üì∫ –°–º–æ—Ç—Ä–µ—Ç—å'::character varying

  INDEXES (1):
    twitch_notification_settings_pkey
      CREATE UNIQUE INDEX twitch_notification_settings_pkey ON public.twitch_notification_settings USING btree (chat_id)

  CONSTRAINTS (4):
    CHECK: 2200_16700_1_not_null
    CHECK: 2200_16700_2_not_null
    CHECK: 2200_16700_3_not_null
    PRIMARY KEY: twitch_notification_settings_pkey

--------------------------------------------------------------------------------
TABLE: twitch_streams

  COLUMNS (13):
    id: bigint NOT NULL DEFAULT nextval('twitch_streams_id_seq'::regclass)
    subscription_id: bigint NOT NULL
    twitch_stream_id: character varying(50) NULL
    started_at: timestamp without time zone NOT NULL
    ended_at: timestamp without time zone NULL
    telegram_message_id: bigint NULL
    telegram_chat_id: bigint NULL
    status: character varying(20) NOT NULL DEFAULT 'live'::character varying
    current_game: character varying(200) NULL
    current_title: text NULL
    viewer_count: integer NULL DEFAULT 0
    telegraph_url: text NULL
    has_photo: boolean NOT NULL DEFAULT false

  INDEXES (3):
    idx_twitch_streams_status
      CREATE INDEX idx_twitch_streams_status ON public.twitch_streams USING btree (status)
    idx_twitch_streams_subscription
      CREATE INDEX idx_twitch_streams_subscription ON public.twitch_streams USING btree (subscription_id)
    twitch_streams_pkey
      CREATE UNIQUE INDEX twitch_streams_pkey ON public.twitch_streams USING btree (id)

  CONSTRAINTS (7):
    CHECK: 2200_16667_13_not_null
    CHECK: 2200_16667_1_not_null
    CHECK: 2200_16667_2_not_null
    CHECK: 2200_16667_4_not_null
    CHECK: 2200_16667_8_not_null
    FOREIGN KEY: twitch_streams_subscription_id_fkey ON DELETE CASCADE
    PRIMARY KEY: twitch_streams_pkey

--------------------------------------------------------------------------------
TABLE: user_preferences

  COLUMNS (4):
    user_id: bigint NOT NULL
    locale: character varying(5) NOT NULL DEFAULT 'en'::character varying
    created_at: timestamp without time zone NULL DEFAULT CURRENT_TIMESTAMP
    updated_at: timestamp without time zone NULL DEFAULT CURRENT_TIMESTAMP

  INDEXES (1):
    user_preferences_pkey
      CREATE UNIQUE INDEX user_preferences_pkey ON public.user_preferences USING btree (user_id)

  CONSTRAINTS (3):
    CHECK: 2200_16574_1_not_null
    CHECK: 2200_16574_2_not_null
    PRIMARY KEY: user_preferences_pkey

--------------------------------------------------------------------------------
TABLE: username_cache

  COLUMNS (6):
    id: bigint NOT NULL DEFAULT nextval('username_cache_id_seq'::regclass)
    username: character varying(255) NOT NULL
    user_id: bigint NOT NULL
    first_name: character varying(255) NULL
    last_name: character varying(255) NULL
    updated_at: timestamp without time zone NOT NULL DEFAULT now()

  INDEXES (4):
    idx_username_cache_user_id
      CREATE INDEX idx_username_cache_user_id ON public.username_cache USING btree (user_id)
    idx_username_cache_username
      CREATE INDEX idx_username_cache_username ON public.username_cache USING btree (username)
    uk_username_cache_username
      CREATE UNIQUE INDEX uk_username_cache_username ON public.username_cache USING btree (username)
    username_cache_pkey
      CREATE UNIQUE INDEX username_cache_pkey ON public.username_cache USING btree (id)

  CONSTRAINTS (6):
    CHECK: 2200_16500_1_not_null
    CHECK: 2200_16500_2_not_null
    CHECK: 2200_16500_3_not_null
    CHECK: 2200_16500_6_not_null
    PRIMARY KEY: username_cache_pkey
    UNIQUE: uk_username_cache_username

--------------------------------------------------------------------------------
TABLE: warnings

  COLUMNS (7):
    id: bigint NOT NULL DEFAULT nextval('warnings_id_seq'::regclass)
    chat_id: bigint NOT NULL
    user_id: bigint NOT NULL
    issued_by_id: bigint NOT NULL
    reason: character varying(500) NULL
    created_at: timestamp without time zone NOT NULL DEFAULT now()
    expires_at: timestamp without time zone NOT NULL

  INDEXES (3):
    idx_warnings_chat_user
      CREATE INDEX idx_warnings_chat_user ON public.warnings USING btree (chat_id, user_id)
    idx_warnings_expires_at
      CREATE INDEX idx_warnings_expires_at ON public.warnings USING btree (expires_at)
    warnings_pkey
      CREATE UNIQUE INDEX warnings_pkey ON public.warnings USING btree (id)

  CONSTRAINTS (7):
    CHECK: 2200_16423_1_not_null
    CHECK: 2200_16423_2_not_null
    CHECK: 2200_16423_3_not_null
    CHECK: 2200_16423_4_not_null
    CHECK: 2200_16423_6_not_null
    CHECK: 2200_16423_7_not_null
    PRIMARY KEY: warnings_pkey

--------------------------------------------------------------------------------
TABLE: welcome_settings

  COLUMNS (7):
    chat_id: bigint NOT NULL
    enabled: boolean NOT NULL DEFAULT true
    message_text: text NULL
    send_to_chat: boolean NOT NULL DEFAULT true
    delete_after_seconds: integer NULL
    created_at: timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP
    updated_at: timestamp with time zone NULL

  INDEXES (2):
    idx_welcome_settings_enabled
      CREATE INDEX idx_welcome_settings_enabled ON public.welcome_settings USING btree (enabled)
    welcome_settings_pkey
      CREATE UNIQUE INDEX welcome_settings_pkey ON public.welcome_settings USING btree (chat_id)

  CONSTRAINTS (5):
    CHECK: 2200_16600_1_not_null
    CHECK: 2200_16600_2_not_null
    CHECK: 2200_16600_4_not_null
    CHECK: 2200_16600_6_not_null
    PRIMARY KEY: welcome_settings_pkey

================================================================================
